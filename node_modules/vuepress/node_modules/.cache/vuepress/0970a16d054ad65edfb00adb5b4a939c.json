{"remainingRequest":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/simao/javascript_code/vuepress/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/simao/javascript_code/vuepress/docs/java/migration.md?vue&type=template&id=f62bd1b4&","dependencies":[{"path":"/Users/simao/javascript_code/vuepress/docs/java/migration.md","mtime":1550041214207},{"path":"/Users/simao/javascript_code/vuepress/node_modules/cache-loader/dist/cjs.js","mtime":1550030168216},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1550030169776},{"path":"/Users/simao/javascript_code/vuepress/node_modules/cache-loader/dist/cjs.js","mtime":1550030168216},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/index.js","mtime":1550030169776},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1550030173624}],"contextDependencies":[],"result":["\n<div class=\"content\"><h1 id=\"migrate-from-umi-1-x\"><a class=\"header-anchor\" href=\"#migrate-from-umi-1-x\" aria-hidden=\"true\">#</a> Migrate from umi 1.x</h1>\n<blockquote>\n<p>More like watching videos? You can <a href=\"https://youtu.be/1mvKzFLLBck\" target=\"_blank\" rel=\"noopener noreferrer\">click here to watch<OutboundLink/></a>.</p>\n</blockquote>\n<p>Let's take an example of <a href=\"https://github.com/zuiidea/antd-admin/pull/877\" target=\"_blank\" rel=\"noopener noreferrer\">antd-admin<OutboundLink/></a> to update from umi@1 to umi@2.</p>\n<h2 id=\"npm-dependency\"><a class=\"header-anchor\" href=\"#npm-dependency\" aria-hidden=\"true\">#</a> npm Dependency</h2>\n<p>Upgrade umi to <code>^2.0.0-0</code> and use umi-plugin-react instead of the previous plugins, including umi-plugin-dva, umi-plugin-dll, umi-plugin-routes, umi-plugin-polyfill and Umi-plugin-locale.</p>\n<!--beforebegin--><div class=\"language-diff line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-diff\"><code><span class=\"token deleted\">- \"umi\": \"^1.3.17\",</span>\n<span class=\"token inserted\">+ \"umi\": \"^2.0.0-beta.16\",</span>\n\n<span class=\"token deleted\">- \"umi-plugin-dll\": \"^0.2.1\",</span>\n<span class=\"token deleted\">- \"umi-plugin-dva\": \"^0.9.1\",</span>\n<span class=\"token deleted\">- \"umi-plugin-routes\": \"^0.1.5\"</span>\n<span class=\"token inserted\">+ \"umi-plugin-react\": \"^1.0.0-beta.16\",</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br></div><!--beforeend--></div><!--afterend--><p>Umi-plugin-react is a collection of more than a dozen plugins, as described in <router-link to=\"/plugin/umi-plugin-react.html\">Introduction to umi-plugin-react</router-link>.</p>\n<h2 id=\"environment-variables\"><a class=\"header-anchor\" href=\"#environment-variables\" aria-hidden=\"true\">#</a> Environment Variables</h2>\n<p>Umi@2 supports configuring environment variables in <code>.env</code>, so the environment variables previously written in package.json scripts can be cut here.</p>\n<!--beforebegin--><div class=\"language-diff line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-diff\"><code><span class=\"token deleted\">- \"start\": \"cross-env COMPILE_ON_DEMAND=none BROWSER=none HOST=0.0.0.0 umi dev\",</span>\n<span class=\"token inserted\">+ \"start\": \"cross-env BROWSER=none HOST=0.0.0.0 umi dev\",</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br></div><!--beforeend--></div><!--afterend--><p>Then create a new <code>.env</code>, (where <code>COMPILE_ON_DEMAND</code> is no longer supported)</p>\n<!--beforebegin--><div class=\"language- line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>BROWSER=none\nHOST=0.0.0.0\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br></div><!--beforeend--></div><!--afterend--><p>In addition, some environment variables have changed or are no longer supported:</p>\n<ul>\n<li><code>PUBLIC_PATH</code> is no longer supported, configured by <code>publicPath</code></li>\n<li><code>BASE_URL</code> is no longer supported, configured by <code>base</code></li>\n<li><code>COMPILE_ON_DEMAND</code> is no longer supported, and this function is not available in umi@2.</li>\n<li><code>TSLINT</code> is no longer supported, and this function is not available in umi@2.</li>\n<li><code>ESLINT</code> is no longer supported, and this function is not available in umi@2.</li>\n</ul>\n<h2 id=\"configuration\"><a class=\"header-anchor\" href=\"#configuration\" aria-hidden=\"true\">#</a> Configuration</h2>\n<h3 id=\"plugin-configuration\"><a class=\"header-anchor\" href=\"#plugin-configuration\" aria-hidden=\"true\">#</a> Plugin Configuration</h3>\n<p>Since we changed a lot of plugins to umi-plugin-react, we need to modify <code>.umirc.js</code>.</p>\n<!--beforebegin--><div class=\"language-diff line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-diff\"><code>export default {\n  plugins: [\n<span class=\"token deleted\">-    'umi-plugin-dva',</span>\n<span class=\"token inserted\">+    ['umi-plugin-react', {</span>\n<span class=\"token inserted\">+      dva: true,</span>\n<span class=\"token inserted\">+      antd: true,  // antd is not enabled by default, if you need to use it yourself</span>\n<span class=\"token inserted\">+    }],</span>\n  ],\n};\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br></div><!--beforeend--></div><!--afterend--><p>For more dll, hardSource, polyfilles, locale, title, etc., refer to <router-link to=\"/plugin/umi-plugin-react.html\">umi-plugin-react documentation</router-link>.</p>\n<h3 id=\"webpackrc-js\"><a class=\"header-anchor\" href=\"#webpackrc-js\" aria-hidden=\"true\">#</a> webpackrc.js</h3>\n<p>Umi@2 no longer supports <code>webpackrc.js</code>, copy the configuration inside it to <code>.umirc.js</code>.</p>\n<h3 id=\"webpack-config-js\"><a class=\"header-anchor\" href=\"#webpack-config-js\" aria-hidden=\"true\">#</a> webpack.config.js</h3>\n<p>Umi@2 no longer supports <code>webpack.config.js</code>, instead it is implemented by configuring <router-link to=\"/config/#chainwebpack\">chainWebpack</router-link>.</p>\n<h3 id=\"detailed-configuration-item-changes\"><a class=\"header-anchor\" href=\"#detailed-configuration-item-changes\" aria-hidden=\"true\">#</a> Detailed Configuration Item Changes</h3>\n<ul>\n<li><code>hd</code> is no longer supported. To enable it, load the plugin <code>umi-plugin-react</code> and configure <code>hd: {}</code></li>\n<li><code>disableServiceWorker</code> is no longer supported, it is not enabled by default. To enable it, load the plugin <code>umi-plugin-react</code> and configure <code>pwa: {}</code></li>\n<li><code>preact</code> is no longer supported. To configure, load the plugin <code>umi-plugin-react</code> and configure `library: 'preact'.</li>\n<li><code>loading</code> is no longer supported. To configure, load the plugin <code>umi-plugin-react</code> and configure <code>dynamicImport.loadingComponent</code></li>\n<li><code>hashHistory: true</code> changed to <code>history: 'hash'</code></li>\n<li><code>disableDynamicImport</code> is no longer supported, it is not enabled by default. To enable it, load the plugin <code>umi-plugin-react</code> and configure <code>dynamicImport: {}</code></li>\n<li><code>disableFastClick</code> is no longer supported, it is not enabled by default. To enable it, load the plugin <code>umi-plugin-react</code> and configure <code>fastClick: {}</code></li>\n<li>No longer supports <code>pages</code>, instead of directly on the route</li>\n<li><code>disableHash</code> is no longer supported, it is not enabled by default. To enable it, configure <code>hash: true</code></li>\n</ul>\n<h2 id=\"conventional-routing\"><a class=\"header-anchor\" href=\"#conventional-routing\" aria-hidden=\"true\">#</a> Conventional Routing</h2>\n<p>The routing layer no longer supports directory-level routing for <code>page.js</code>. Previously useful, you need to exclude unwanted routes through umi-plugin-react's routes.exclude.</p>\n<h2 id=\"umi-dynamic\"><a class=\"header-anchor\" href=\"#umi-dynamic\" aria-hidden=\"true\">#</a> umi/dynamic</h2>\n<p>Interface changes, umi@2 is based on <a href=\"https://github.com/jamiebuilds/react-loadable\" target=\"_blank\" rel=\"noopener noreferrer\">react-loadable<OutboundLink/></a>.</p>\n<!--beforebegin--><div class=\"language-diff line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-diff\"><code><span class=\"token deleted\">- dynamic(async () => {})</span>\n<span class=\"token inserted\">+ dynamic({ loader: async () => {}})</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br></div><!--beforeend--></div><!--afterend--><p>See <router-link to=\"/api/#umi-dynamic\">umi/dynamic Interface Description</router-link> for details.</p>\n</div>\n",null]}