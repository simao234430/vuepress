{"remainingRequest":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/simao/javascript_code/vuepress/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/simao/javascript_code/vuepress/docs/java/deploy.md?vue&type=template&id=1b826222&","dependencies":[{"path":"/Users/simao/javascript_code/vuepress/docs/java/deploy.md","mtime":1550041214206},{"path":"/Users/simao/javascript_code/vuepress/node_modules/cache-loader/dist/cjs.js","mtime":1550030168216},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1550030169776},{"path":"/Users/simao/javascript_code/vuepress/node_modules/cache-loader/dist/cjs.js","mtime":1550030168216},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vue-loader/lib/index.js","mtime":1550030169776},{"path":"/Users/simao/javascript_code/vuepress/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1550030173624}],"contextDependencies":[],"result":["\n<div class=\"content\"><h1 id=\"deploy\"><a class=\"header-anchor\" href=\"#deploy\" aria-hidden=\"true\">#</a> Deploy</h1>\n<h2 id=\"default-scheme\"><a class=\"header-anchor\" href=\"#default-scheme\" aria-hidden=\"true\">#</a> Default Scheme</h2>\n<p>Umi@2 is friendly to newbies by default, so it does not load on-demand by default. After <code>umi build</code>, it outputs three files: <code>index.html</code>, <code>umi.js</code> and <code>umi.css</code>.</p>\n<h2 id=\"do-not-output-html-files\"><a class=\"header-anchor\" href=\"#do-not-output-html-files\" aria-hidden=\"true\">#</a> Do Not Output HTML Files</h2>\n<p>Some scene html files are handed to the backend output. The frontend build does not need to output html files. The environment variable <code>HTML=none</code> is configurable.</p>\n<!--beforebegin--><div class=\"language-bash line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code>$ HTML<span class=\"token operator\">=</span>none umi build\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"deploy-html-to-a-non-root-directory\"><a class=\"header-anchor\" href=\"#deploy-html-to-a-non-root-directory\" aria-hidden=\"true\">#</a> Deploy HTML to a Non-Root Directory</h2>\n<p>I often have students asking this question:</p>\n<blockquote>\n<p>Why is my local development good, no response after deployment, and no error?</p>\n</blockquote>\n<p><strong>No error!</strong> This is a typical phenomenon where an application is deployed on a non-root path. Why do you have this problem? Because the route does not match, for example, if you deploy the application under <code>/xxx/</code> and then access <code>/xxx/hello</code>, and the code matches <code>/hello</code>, then it will not match, but there is no definition. A fallback route, such as 404, will display a blank page.</p>\n<p>How to deal with it?</p>\n<p>Can be solved by configuring <router-link to=\"/config/#base\">base</router-link>.</p>\n<!--beforebegin--><div class=\"language-bash line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token function\">export</span> default <span class=\"token punctuation\">{</span>\n  base: <span class=\"token string\">'/path/to/your/app/root'</span>,\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"use-hashhistory\"><a class=\"header-anchor\" href=\"#use-hashhistory\" aria-hidden=\"true\">#</a> Use hashHistory</h2>\n<p>This can be solved by configuring <router-link to=\"/config/#history\">history</router-link> for <code>hash</code>.</p>\n<!--beforebegin--><div class=\"language-bash line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token function\">export</span> default <span class=\"token punctuation\">{</span>\n  history: <span class=\"token string\">'hash'</span>,\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"load-on-demand\"><a class=\"header-anchor\" href=\"#load-on-demand\" aria-hidden=\"true\">#</a> Load on Demand</h2>\n<p>To implement on-demand loading, load the umi-plugin-react plugin and configure <router-link to=\"/plugin/umi-plugin-react.html#dynamicimport\">dynamicImport</router-link>.</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'umi-plugin-react'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      dynamicImport<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br></div><!--beforeend--></div><!--afterend--><p>See the parameter <router-link to=\"/plugin/umi-plugin-react.html#dynamicimport\">umi-plugin-react#dynamicImport</router-link> for details.</p>\n<h2 id=\"static-resources-in-non-root-directory-or-cdn\"><a class=\"header-anchor\" href=\"#static-resources-in-non-root-directory-or-cdn\" aria-hidden=\"true\">#</a> Static Resources in Non-Root Directory or CDN</h2>\n<p>At this point, you need to configure <router-link to=\"/config/#publicPath\">publicPath</router-link>. As for publicPath, what? Look at the <a href=\"https://webpack.js.org/configuration/output/#output-publicpath\" target=\"_blank\" rel=\"noopener noreferrer\">webpack documentation<OutboundLink/></a> and point it to the path where the static resources (js, css, images, fonts, etc.) are located.</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  publicPath<span class=\"token punctuation\">:</span> <span class=\"token string\">\"http://yourcdn/path/to/static/\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"using-the-publicpath-of-runtime\"><a class=\"header-anchor\" href=\"#using-the-publicpath-of-runtime\" aria-hidden=\"true\">#</a> Using the publicPath of Runtime</h2>\n<p>For scenes that need to manage publicPath in html, such as judging the environment to make different output in html, you can solve it by configuring <router-link to=\"/config/#runtimepublicpath\">runtimePublicPath</router-link>.</p>\n<!--beforebegin--><div class=\"language-bash line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token function\">export</span> default <span class=\"token punctuation\">{</span>\n  runtimePublicPath: true,\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><p>Then output in html:</p>\n<!--beforebegin--><div class=\"language-html line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-html\"><code><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\">\nwindow<span class=\"token punctuation\">.</span>publicPath <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">%=</span> <span class=\"token constant\">YOUR_PUBLIC_PATH</span> <span class=\"token operator\">%</span><span class=\"token operator\">></span>\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"static\"><a class=\"header-anchor\" href=\"#static\" aria-hidden=\"true\">#</a> Static</h2>\n<p>In some scenarios, you can't do html fallback on the server side, that is, let each route output the contents of index.html, then it needs to be static.</p>\n<p>For example, in the above example, we configured in .umirc.js:</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  exportStatic<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><p>Then execute the umi build and output an html file for each route.</p>\n<!--beforebegin--><div class=\"language- line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>./dist\n├── index.html\n├── list\n│   └── index.html\n└── static\n    ├── pages__index.5c0f5f51.async.js\n    ├── pages__list.f940b099.async.js\n    ├── umi.2eaebd79.js\n    └── umi.f4cb51da.css\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br><span class=\"line-number\">9</span><br></div><!--beforeend--></div><!--afterend--><blockquote>\n<p>Note: Statics does not support scenarios with variable routing.</p>\n</blockquote>\n<h2 id=\"html-suffix\"><a class=\"header-anchor\" href=\"#html-suffix\" aria-hidden=\"true\">#</a> HTML Suffix</h2>\n<p>In some static scenarios, the index file is not automatically read, such as Alipay's container environment, then this html file cannot be generated.</p>\n<!--beforebegin--><div class=\"language- line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>├── index.html\n├── list\n│   └── index.html\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br></div><!--beforeend--></div><!--afterend--><p>But generate,</p>\n<!--beforebegin--><div class=\"language- line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>├── index.html\n└── list.html\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br></div><!--beforeend--></div><!--afterend--><p>The configuration is in .umirc.js,</p>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n   exportStatic<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n     htmlSuffix<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br></div><!--beforeend--></div><!--afterend--><p>Umi build will generate,</p>\n<!--beforebegin--><div class=\"language- line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>./dist\n├── index.html\n├── list.html\n└── static\n     ├── pages__index.5c0f5f51.async.js\n     ├── pages__list.f940b099.async.js\n     ├── umi.2924fdb7.js\n     └── umi.cfe3ffab.css\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br><span class=\"line-number\">7</span><br><span class=\"line-number\">8</span><br></div><!--beforeend--></div><!--afterend--><h2 id=\"statically-output-to-any-path\"><a class=\"header-anchor\" href=\"#statically-output-to-any-path\" aria-hidden=\"true\">#</a> Statically Output to Any Path</h2>\n<!--beforebegin--><div class=\"language-js line-numbers-mode\"><!--afterbegin--><pre v-pre class=\"language-js\"><code><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  exportStatic<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    htmlSuffix<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    dynamicRoot<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<div class=\"line-numbers-wrapper\"><span class=\"line-number\">1</span><br><span class=\"line-number\">2</span><br><span class=\"line-number\">3</span><br><span class=\"line-number\">4</span><br><span class=\"line-number\">5</span><br><span class=\"line-number\">6</span><br></div><!--beforeend--></div><!--afterend--></div>\n",null]}