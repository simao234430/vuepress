<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mock Data | 肖总教java</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.ebcf3451.css" as="style"><link rel="preload" href="/assets/js/app.f5cc174e.js" as="script"><link rel="preload" href="/assets/js/18.bc02023f.js" as="script"><link rel="prefetch" href="/assets/js/10.bf39ec18.js"><link rel="prefetch" href="/assets/js/11.210e0db4.js"><link rel="prefetch" href="/assets/js/12.ffb3dc49.js"><link rel="prefetch" href="/assets/js/13.7299ff02.js"><link rel="prefetch" href="/assets/js/14.1e018a41.js"><link rel="prefetch" href="/assets/js/15.c7d46dc9.js"><link rel="prefetch" href="/assets/js/16.aa71f129.js"><link rel="prefetch" href="/assets/js/17.ee9ad401.js"><link rel="prefetch" href="/assets/js/19.ac6195b2.js"><link rel="prefetch" href="/assets/js/2.0f4038f2.js"><link rel="prefetch" href="/assets/js/20.000b2e2e.js"><link rel="prefetch" href="/assets/js/21.cda796ee.js"><link rel="prefetch" href="/assets/js/22.b96309d1.js"><link rel="prefetch" href="/assets/js/23.24f97e00.js"><link rel="prefetch" href="/assets/js/24.897297e4.js"><link rel="prefetch" href="/assets/js/3.52b528e1.js"><link rel="prefetch" href="/assets/js/4.c1e06c01.js"><link rel="prefetch" href="/assets/js/5.c4dd6f34.js"><link rel="prefetch" href="/assets/js/6.1701df0e.js"><link rel="prefetch" href="/assets/js/7.e872f69f.js"><link rel="prefetch" href="/assets/js/8.b5f42330.js"><link rel="prefetch" href="/assets/js/9.444abcb4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ebcf3451.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">肖总教java</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link router-link-active">java</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link router-link-active">java</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>java</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/java/" class="sidebar-link">Introduction</a></li><li><a href="/java/java_intro.html" class="sidebar-link">java入门</a></li><li><a href="/java/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/java/create-umi-app.html" class="sidebar-link">Create a Project With create-umi</a></li><li><a href="/java/examples.html" class="sidebar-link">Examples</a></li><li><a href="/java/app-structure.html" class="sidebar-link">Directory and Convention</a></li><li><a href="/java/router.html" class="sidebar-link">Router</a></li><li><a href="/java/navigate-between-pages.html" class="sidebar-link">Navigate between pages</a></li><li><a href="/java/config.html" class="sidebar-link">Configuration</a></li><li><a href="/java/html-template.html" class="sidebar-link">HTML Template</a></li><li><a href="/java/test.html" class="sidebar-link">Introduction</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Advanced</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/java/mock-data.html" class="active sidebar-link">Mock Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/java/mock-data.html#using-the-mock-feature-of-umi" class="sidebar-link">Using the mock feature of umi</a></li><li class="sidebar-sub-header"><a href="/java/mock-data.html#properly-split-your-mock-file" class="sidebar-link">Properly split your mock file</a></li><li class="sidebar-sub-header"><a href="/java/mock-data.html#how-to-simulate-delay" class="sidebar-link">How to simulate delay</a></li><li class="sidebar-sub-header"><a href="/java/mock-data.html#dynamic-mock-data" class="sidebar-link">Dynamic mock data</a></li><li class="sidebar-sub-header"><a href="/java/mock-data.html#joint-debugging" class="sidebar-link">Joint debugging</a></li></ul></li><li><a href="/java/with-dva.html" class="sidebar-link">Use umi with dva</a></li><li><a href="/java/load-on-demand.html" class="sidebar-link">Load on demand</a></li><li><a href="/java/runtime-config.html" class="sidebar-link">Runtime Config</a></li><li><a href="/java/block.html" class="sidebar-link">Block</a></li><li><a href="/java/deploy.html" class="sidebar-link">Deploy</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Reference</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/java/faq.html" class="sidebar-link">FAQ</a></li><li><a href="/java/migration.html" class="sidebar-link">Migrate from umi 1.x</a></li><li><a href="/java/env-variables.html" class="sidebar-link">.env and Environment Variables</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="mock-data"><a href="#mock-data" aria-hidden="true" class="header-anchor">#</a> Mock Data</h1> <p>Mock data is indispensable in front-end development process and it is the key link to separate the front-end from the back-end. Through the pre-agreed interface with the server-side, simulation request data and even logic, can make the front-end development independent, will not be blocked by the development of the server-side.</p> <h2 id="using-the-mock-feature-of-umi"><a href="#using-the-mock-feature-of-umi" aria-hidden="true" class="header-anchor">#</a> Using the mock feature of umi</h2> <p>Umi agreed that the files under the mock folder or _mock.js in page(s) folder are mock files, files export interface definitions, support for real-time refresh based on 'require' dynamic analysis, support for ES6 syntax, and with friendly error messages, see <a href="https://umijs.org/guide/mock-data.html" target="_blank" rel="noopener noreferrer">mock-data<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more detail.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// supported values are Object and Array</span>
  <span class="token string">'GET /api/users'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> users<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// GET and POST can be omitted</span>
  <span class="token string">'/api/users/1'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// support for custom functions, APIs refer to express@4</span>
  <span class="token string">'POST /api/users/create'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>When a client(browser) sends a request, such as <code>GET /api/users</code>, the locally launched <code>umi dev</code> will match the request path and method with this configuration file, if it find a match, the request will be processed through configuration, just like the sample, you can directly return the data, or process and redirect it to another server through a function.</p> <p>For example, define the following mapping rules as below:</p> <div class="language- extra-class"><pre class="language-text"><code>'GET /api/currentUser': {
  name: 'momo.zxy',
  avatar: imgMap.user,
  userid: '00000001',
  notifyCount: 12,
},
</code></pre></div><p>Request local interface <code>/api/users</code>:</p> <p>Request header</p> <img src="https://gw.alipayobjects.com/zos/rmsportal/ZdlcFoYonSGDupWnktZn.png" width="400"> <p>Response data</p> <img src="https://gw.alipayobjects.com/zos/rmsportal/OLHIXePGHkkFoaZVQAts.png" width="600"> <h3 id="introduce-mock-js"><a href="#introduce-mock-js" aria-hidden="true" class="header-anchor">#</a> Introduce Mock.js</h3> <p><a href="http://mockjs.com/" target="_blank" rel="noopener noreferrer">Mock.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a commonly used third-party library to help generate mock data. Of course, you can use any library you like working with roadhog to build data simulation functions.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> mockjs <span class="token keyword">from</span> <span class="token string">'mockjs'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use third-party library such as mockjs</span>
  <span class="token string">'GET /api/tags'</span><span class="token punctuation">:</span> mockjs<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'list|100'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'@city'</span><span class="token punctuation">,</span> <span class="token string">'value|1-100'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'type|0-2'</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="add-a-cross-domain-request-header"><a href="#add-a-cross-domain-request-header" aria-hidden="true" class="header-anchor">#</a> Add a cross-domain request header</h3> <p>Just set the header of <code>response</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>'POST /api/users/create': (req, res) =&gt; {
  ...
  res.setHeader('Access-Control-Allow-Origin', '*');
  ...
},
</code></pre></div><h2 id="properly-split-your-mock-file"><a href="#properly-split-your-mock-file" aria-hidden="true" class="header-anchor">#</a> Properly split your mock file</h2> <p>For the entire system, the request interface is complex and numerous, in order to handle a large number of mock request scenarios, we usually abstract each data model into a file, and put them all in the <code>mock</code> folder. And then they will be automatically introduced.</p> <img src="https://gw.alipayobjects.com/zos/rmsportal/wbeiDacBkchXrTafasBy.png" width="200"> <h2 id="how-to-simulate-delay"><a href="#how-to-simulate-delay" aria-hidden="true" class="header-anchor">#</a> How to simulate delay</h2> <p>In order to simulate the network data request more realistically, it is necessary to simulate network delay time in most cases.</p> <h3 id="add-settimeout-manually-to-simulate-delay"><a href="#add-settimeout-manually-to-simulate-delay" aria-hidden="true" class="header-anchor">#</a> Add setTimeout manually to simulate delay</h3> <p>You can rewrite the proxy method of the request and add the processing of simulation delay to it, like:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'POST /api/forms'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="use-plugins-to-simulate-delay"><a href="#use-plugins-to-simulate-delay" aria-hidden="true" class="header-anchor">#</a> Use plugins to simulate delay</h3> <p>Although the method above is simple, it may be troublesome when you need to add delays for all request, it can be simplified by a third-party plugin，such as <a href="https://github.com/nikogu/roadhog-api-doc/blob/master/lib/utils.js#L5" target="_blank" rel="noopener noreferrer">roadhog-api-doc#delay<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> delay <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'roadhog-api-doc'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'GET /api/project/notice'</span><span class="token punctuation">:</span> getNotice<span class="token punctuation">,</span>
  <span class="token string">'GET /api/activities'</span><span class="token punctuation">:</span> getActivities<span class="token punctuation">,</span>
  <span class="token string">'GET /api/rule'</span><span class="token punctuation">:</span> getRule<span class="token punctuation">,</span>
  <span class="token string">'GET /api/tags'</span><span class="token punctuation">:</span> mockjs<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'list|100'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'@city'</span><span class="token punctuation">,</span> <span class="token string">'value|1-100'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">'type|0-2'</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string">'GET /api/fake_list'</span><span class="token punctuation">:</span> getFakeList<span class="token punctuation">,</span>
  <span class="token string">'GET /api/fake_chart_data'</span><span class="token punctuation">:</span> getFakeChartData<span class="token punctuation">,</span>
  <span class="token string">'GET /api/profile/basic'</span><span class="token punctuation">:</span> getProfileBasicData<span class="token punctuation">,</span>
  <span class="token string">'GET /api/profile/advanced'</span><span class="token punctuation">:</span> getProfileAdvancedData<span class="token punctuation">,</span>
  <span class="token string">'POST /api/register'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token punctuation">:</span> <span class="token string">'ok'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'GET /api/notices'</span><span class="token punctuation">:</span> getNotices<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Calling the delay function, unified processing</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">delay</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="dynamic-mock-data"><a href="#dynamic-mock-data" aria-hidden="true" class="header-anchor">#</a> Dynamic mock data</h2> <p>If you want to generate dynamic mock data on every request, you should use functions.</p> <p>For example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// undynamic</span>
<span class="token string">'/api/random'</span><span class="token punctuation">:</span> Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// random once only</span>
  <span class="token string">'number|1-100'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// dynamic</span>
<span class="token string">'/api/random'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// random every request</span>
    <span class="token string">'number|1-100'</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="joint-debugging"><a href="#joint-debugging" aria-hidden="true" class="header-anchor">#</a> Joint debugging</h2> <p>After finishing the local development, if the interface of server-side meets the previous convention, you only need to open the local proxy or redirect the proxy to the target server to access the real server data, which is very convenient.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java/test.html" class="prev">
          Introduction
        </a></span> <span class="next"><a href="/java/with-dva.html">
          Use umi with dva
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.f5cc174e.js" defer></script><script src="/assets/js/18.bc02023f.js" defer></script>
  </body>
</html>
